{% extends "global/Page.html" %}

{% block custom_styles %}
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700&display=swap');
  @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css');

  body { font-family: 'Montserrat', sans-serif; }
</style>
{% endblock %}

{% block content %}
<div class="d-flex align-items-center mb-4 p-3 rounded bg-light border">
  <i class="fas fa-sync-alt me-3 text-primary" style="font-size:1.6rem;"></i>
  <div>
    <div class="text-muted small">Step 5</div>
    <h4 class="mb-0 fw-semibold">Update your opinion</h4>
  </div>
</div>

<p>
  After seeing your group members’ opinions and motivations, you may update your opinion using the slider below.
</p>

<div class="card mb-4 shadow-sm">
  <div class="card-body">

    <label class="form-label mb-3 d-block bg-light p-2 rounded">
      <strong>{{ statement }}</strong>
    </label>

    <div class="mb-3 text-muted small">
      Your initial opinion:
      <span class="badge bg-secondary ms-2" id="initialBadge">{{ initial_opinion }}</span>
    </div>

    <div class="d-flex align-items-center gap-3">
      <span class="text-muted" style="min-width:180px;">−10 (Totally disagree)</span>

      <input
        type="range"
        class="form-range flex-grow-1 opinion-slider"
        name="updated_opinion"
        id="id_updated_opinion"
        min="-10"
        max="10"
        step="1"
        value="{{ initial_opinion }}"
        oninput="document.getElementById('val_updated_opinion').textContent = this.value;"
      >

      <span class="badge bg-secondary" id="val_updated_opinion">{{ initial_opinion }}</span>

      <span class="text-muted" style="min-width:180px; text-align:right;">
        10 (Totally agree)
      </span>
    </div>

  </div>
</div>


<div class="text-center mt-4">
  {{ next_button }}
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const slider = document.getElementById('id_updated_opinion');
    const badge = document.getElementById('val_updated_opinion');
    if (slider && badge) badge.textContent = slider.value;

    const nextBtn = document.querySelector('button.otree-btn-next');
    if (nextBtn) {
      nextBtn.addEventListener('click', function (event) {
        const confirmed = confirm('Are you sure you want to submit your updated opinion?');
        if (!confirmed) event.preventDefault();
      });
    }
  });
</script>
{% endblock %}
